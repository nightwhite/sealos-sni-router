# ============================================================================
# Sealos SNI 路由器 - 环境变量配置示例
# ============================================================================
# 复制此文件为 .env，然后根据需要修改配置
# cp .env.example .env
#
# 支持三种存储模式：
# 1. sqlite-memory: SQLite + 内存（单机模式，推荐开发环境）
# 2. sqlite-eventbus: SQLite + 内存事件总线（单机模式，无需 Redis）
# 3. postgresql-redis: PostgreSQL + Redis（高可用分布式模式）
# ============================================================================

# ============================================================================
# 基础配置
# ============================================================================

# Web 管理界面端口
# 默认值: 3000
PORT=3000

# 运行环境
# 可选值: development, production, test
# 默认值: development
NODE_ENV=development

# ============================================================================
# 数据库配置
# ============================================================================
# 支持 SQLite 和 PostgreSQL 两种数据库

# 数据库连接 URL
# SQLite 格式: sqlite://./data/sni-router.db
# PostgreSQL 格式: postgresql://user:password@host:5432/database
# 默认值: 不配置（使用内存存储，重启后配置丢失）
# DATABASE_URL=sqlite://./data/sni-router.db

# ============================================================================
# Redis 配置（可选）
# ============================================================================
# 仅在使用 PostgreSQL 时需要配置 Redis（用于多副本同步）
# 如果使用 SQLite，不需要配置 Redis

# Redis 连接 URL
# 格式: redis://[username:password@]host[:port][/database]
# 示例:
#   - redis://localhost:6379
#   - redis://user:password@redis.example.com:6379
#   - redis://redis-service.default.svc.cluster.local:6379
# 默认值: 不配置
# REDIS_URL=redis://localhost:6379

# ============================================================================
# 日志配置
# ============================================================================

# 日志级别
# 可选值: debug, info, warn, error
# 默认值: info
# LOG_LEVEL=info

# ============================================================================
# SNI 路由器配置
# ============================================================================

# SNI 路由器监听端口
# 这是 HTTPS 流量的入口端口
# 默认值: 9443
# SNI_ROUTER_PORT=9443

# ============================================================================
# 模式 1: SQLite + 内存（单机开发环境）
# ============================================================================
# 最简单的配置，适合本地开发和单机部署
# 数据持久化到 SQLite，配置变更通过内存事件总线同步

# PORT=3000
# NODE_ENV=development
# DATABASE_URL=sqlite://./data/sni-router.db

# ============================================================================
# 模式 2: SQLite + 内存事件总线（单机生产环境）
# ============================================================================
# 适合单机生产环境，无需 Redis
# 数据持久化到 SQLite，配置变更通过内存事件总线同步

# PORT=3000
# NODE_ENV=production
# DATABASE_URL=sqlite://./data/sni-router.db

# ============================================================================
# 模式 3: PostgreSQL + Redis（高可用分布式）
# ============================================================================
# 适合 Kubernetes 和分布式部署
# 数据持久化到 PostgreSQL，配置通过 Redis Pub/Sub 同步到多个副本

# PORT=3000
# NODE_ENV=production
# DATABASE_URL=postgresql://user:password@postgres-service.default.svc.cluster.local:5432/sni_router
# REDIS_URL=redis://redis-service.default.svc.cluster.local:6379

# ============================================================================
# Kubernetes 环境示例（高可用）
# ============================================================================
# 在 Kubernetes 中使用时的推荐配置

# PORT=3000
# NODE_ENV=production
# DATABASE_URL=postgresql://user:password@postgres-service.default.svc.cluster.local:5432/sni_router
# REDIS_URL=redis://redis-service.default.svc.cluster.local:6379

# ============================================================================
# Docker Compose 示例（单机）
# ============================================================================
# 使用 docker-compose.yml 时的推荐配置

# PORT=3000
# NODE_ENV=production
# DATABASE_URL=sqlite://./data/sni-router.db

# ============================================================================
# 注意事项
# ============================================================================
# 1. 不要将 .env 文件提交到版本控制系统
# 2. 生产环境应该使用强密码和 TLS 连接
# 3. Redis 密码应该使用强密码
# 4. 定期更新依赖包以获得安全补丁
# 5. 使用 HTTPS 访问管理界面
# ============================================================================

